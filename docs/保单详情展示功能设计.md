# 保单详情展示功能设计文档

## 一、功能概述

为用户提供保单合同的可视化解析展示，帮助用户快速了解保单的核心保障内容。

---

## 二、入口设计

### 入口1：我的家庭保单 → 保险卡片

**位置**：保险卡片右侧，与编辑/删除按钮并列

**交互方式**：Accordion 展开

**效果示意**：

```
┌─────────────────────────────────────────────────────────────────┐
│ 🛡️ 百年康惠保（旗舰版2.0）              重疾险                  │
│    百年人寿[2020]疾病保险009号                                   │
│                                                                 │
│    本人 · 2000年(26岁)                                          │
│    投保：2026年 → 终身  |  缴费：20年  |  年缴：5,000元          │
│                                     [查看合同详情] [✏️] [🗑️]    │
├─────────────────────────────────────────────────────────────────┤
│                        ↓ 展开后 ↓                               │
├─────────────────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────────────────────────────┐  │
│  │                     📋 合同详情解析                        │  │
│  │  ─────────────────────────────────────────────────────────│  │
│  │                                                           │  │
│  │  【保障责任与保额】                                         │  │
│  │  ┌─────────────────────────────────────────────────┐      │  │
│  │  │           重大疾病保险金    70万                 │      │  │
│  │  │  ┌────────────────┬────────────────┐            │      │  │
│  │  │  │ 中症疾病保险金  │ 轻症疾病保险金  │            │      │  │
│  │  │  │     35万       │     21万       │            │      │  │
│  │  │  └────────────────┴────────────────┘            │      │  │
│  │  └─────────────────────────────────────────────────┘      │  │
│  │                                                           │  │
│  │  【保障期限】                                               │  │
│  │  [当前 26岁] ━━━━━━━━━━━━━━━━━━━━━━━━━━━━ [终身 100岁]      │  │
│  │                                                           │  │
│  │  【给付方式】                                               │  │
│  │  ┌────────────────────────────────────────────────┐       │  │
│  │  │ 重疾给付  [分组二次] [无间隔期]  ▶ 比例：100%   │       │  │
│  │  │ 中症给付  [三次]    [无间隔期]  ▶ 比例：50%    │       │  │
│  │  │ 轻症给付  [三次]    [无间隔期]  ▶ 比例：30%    │       │  │
│  │  └────────────────────────────────────────────────┘       │  │
│  │                                                           │  │
│  │  【身故责任】                                               │  │
│  │  [不包含]                                                  │  │
│  │                                                           │  │
│  │  【豁免保费】                                               │  │
│  │  [轻症豁免] [中症豁免] [重疾豁免]                           │  │
│  │                                                           │  │
│  └───────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

**交互细节**：
- 点击"查看合同详情"按钮，在卡片下方平滑展开详情区域
- 再次点击按钮或点击详情区域外部，收起详情
- 同一时间只展开一个保单的详情（点击另一个保单时自动收起当前的）

---

### 入口2：智能快录 → 保存按钮旁

**位置**：与"保存合同"按钮并列（左侧）

**交互方式**：右侧弹窗（Drawer from right）

**效果示意**：

```
┌─────────────────────────────────────┬────────────────────────────┐
│                                     │                            │
│         智能快录页面                 │     📋 合同详情预览        │
│                                     │                            │
│   [表单内容...]                      │   【保障责任与保额】        │
│                                     │   ┌─────────────────┐      │
│                                     │   │ 重大疾病保险金   │      │
│                                     │   │     70万        │      │
│                                     │   └─────────────────┘      │
│                                     │                            │
│                                     │   【保障期限】              │
│                                     │   [当前] ━━━━ [终身]       │
│                                     │                            │
│                                     │   【给付方式】              │
│                                     │   重疾给付 [分组二次]...    │
│                                     │                            │
│   ┌─────────────────────────────┐   │                            │
│   │ [查看合同详情]  [保存合同]   │   │                            │
│   └─────────────────────────────┘   │                            │
│                                     │                 [关闭]     │
└─────────────────────────────────────┴────────────────────────────┘
```

**交互细节**：
- 点击"查看合同详情"按钮，从右侧滑出 Drawer
- Drawer 宽度：480px
- 点击遮罩层或关闭按钮，收起 Drawer
- 实时显示当前表单数据的预览效果

---

## 三、数据字段映射

### 3.1 保障责任与保额

| 展示项 | 数据来源 | 计算逻辑 |
|--------|----------|----------|
| 保险金额 | `basicSumInsured` | 直接显示，单位：万 |
| 重大疾病保险金 | `coverages[type=重疾保险金].keyAmounts[0].amount` | 取第一个阶段金额 |
| 中症疾病保险金 | `coverages[type=中症保险金].keyAmounts[0].amount` | 取第一个阶段金额 |
| 轻症疾病保险金 | `coverages[type=轻症保险金].keyAmounts[0].amount` | 取第一个阶段金额 |

**金额层级展示规则**：
- 重疾保险金最大，显示在最上层
- 中症、轻症按比例缩小，显示在下层
- 如果某类责任不存在，不显示对应区块

### 3.2 保障期限

| 展示项 | 数据来源 | 计算逻辑 |
|--------|----------|----------|
| 当前年龄 | `birthYear` | `当前年份 - birthYear` |
| 结束年龄 | `coverageEndYear` | `lifetime` 显示为 100岁，否则 `coverageEndYear - birthYear` |
| 进度条 | 计算得出 | `(当前年龄 - 投保年龄) / (结束年龄 - 投保年龄) * 100%` |

### 3.3 给付方式

| 展示项 | 数据来源 | 取值说明 |
|--------|----------|----------|
| 给付次数 | `coverage.payoutCount` | `single`→单次, `multiple`→多次, 数字→具体次数 |
| 间隔期 | `coverage.intervalPeriod` | `none`→无间隔期, 有值则显示具体天数 |
| 分组信息 | `coverage.grouping` | `grouped`→分组, `ungrouped`→不分组 |
| 给付比例 | `coverage.formula` | 解析公式中的百分比 |

**责任类型映射**：

| 责任类型 | 显示名称 | 颜色 |
|----------|----------|------|
| 重疾保险金 | 重疾给付 | #ff6b6b (红) |
| 中症保险金 | 中症给付 | #ffa726 (橙) |
| 轻症保险金 | 轻症给付 | #66bb6a (绿) |

### 3.4 身故责任

| 状态 | 判断逻辑 | 展示 |
|------|----------|------|
| 不包含 | 无 `coverages[type=身故]` | 灰色标签 `[不包含]` |
| 返保费 | `formula` 含"已交保费" | 蓝色标签 `[返保费]` |
| 赔保额 | `formula` 含"保额" | 绿色标签 `[赔保额]` |

**当前版本**：默认显示 `[不包含]`，后续扩展

### 3.5 豁免保费

| 展示项 | 数据来源 | 判断逻辑 |
|--------|----------|----------|
| 轻症豁免 | `coverages[].premiumWaiver` | 含"轻症"关键词 |
| 中症豁免 | `coverages[].premiumWaiver` | 含"中症"关键词 |
| 重疾豁免 | `coverages[].premiumWaiver` | 含"重疾/重大疾病"关键词 |

---

## 四、UI 设计规范

### 4.1 配色方案

```css
/* 主色调 */
--primary-color: #01BCD6;      /* 品牌蓝 */
--primary-light: #e6f7fa;      /* 浅蓝背景 */

/* 责任类型颜色 */
--critical-illness: #ff6b6b;   /* 重疾 - 红色 */
--moderate-illness: #ffa726;   /* 中症 - 橙色 */
--mild-illness: #66bb6a;       /* 轻症 - 绿色 */

/* 标签颜色 */
--tag-active: #01BCD6;         /* 激活标签 */
--tag-inactive: #e0e0e0;       /* 未激活标签 */
--tag-text: #666666;           /* 标签文字 */

/* 背景 */
--card-bg: rgba(255, 255, 255, 0.9);
--section-bg: #f8fafc;
```

### 4.2 字体规范

| 元素 | 字号 | 字重 | 颜色 |
|------|------|------|------|
| 模块标题 | 16px | 600 | #333 |
| 金额数字 | 28px | 700 | #01BCD6 |
| 金额单位 | 14px | 400 | #666 |
| 标签文字 | 12px | 500 | #666 |
| 说明文字 | 13px | 400 | #999 |

### 4.3 间距规范

| 元素 | 间距 |
|------|------|
| 模块之间 | 24px |
| 模块标题与内容 | 12px |
| 标签之间 | 8px |
| 卡片内边距 | 20px |

---

## 五、组件结构

```
components/
└── PolicyDetailCard/
    ├── index.tsx                    # 主组件（根据模式渲染）
    ├── PolicyDetailContent.tsx      # 详情内容（复用）
    ├── CoverageAmountChart.tsx      # 保额层级图
    ├── CoveragePeriodBar.tsx        # 保障期限进度条
    ├── PayoutMethodSection.tsx      # 给付方式区块
    └── styles.module.css            # 样式文件
```

### 组件接口定义

```typescript
// PolicyDetailCard 组件 Props
interface PolicyDetailCardProps {
  // 展示模式
  mode: 'accordion' | 'drawer';
  
  // 保单数据
  policy: {
    productName: string;
    policyIdNumber?: string;
    basicSumInsured: number;
    birthYear: number;
    policyStartYear: number;
    coverageEndYear: number | 'lifetime';
    coverages: Coverage[];
  };
  
  // 控制展开/关闭（accordion模式）
  expanded?: boolean;
  onExpandChange?: (expanded: boolean) => void;
  
  // 控制显示/隐藏（drawer模式）
  visible?: boolean;
  onClose?: () => void;
}
```

---

## 六、实现计划

### 阶段一：核心组件开发（Day 1）

- [ ] 创建 `PolicyDetailContent.tsx` 详情内容组件
- [ ] 实现保障责任与保额展示
- [ ] 实现保障期限进度条
- [ ] 实现给付方式区块
- [ ] 实现身故责任展示（默认不包含）
- [ ] 实现豁免保费展示

### 阶段二：入口集成（Day 2）

- [ ] 入口1：`PolicyManagerHomePage.tsx` 添加 accordion 展开功能
- [ ] 入口2：`SmartInputPage.tsx` 添加右侧 Drawer
- [ ] 测试两个入口的数据传递
- [ ] 调整样式和交互细节

### 阶段三：优化完善（Day 3）

- [ ] 展开/收起动画优化
- [ ] 空数据状态处理
- [ ] 响应式适配
- [ ] 测试和Bug修复

---

## 七、后续扩展

1. **病种列表展示**：解析责任条款中的病种数量和名称
2. **身故责任解析**：新增身故责任的数据采集和展示
3. **保单对比功能**：支持选择多个保单进行对比
4. **导出PDF**：支持将详情导出为PDF文档

---

## 八、确认项

- [x] 入口1 交互方式：Accordion 展开
- [x] 入口2 展示位置：右侧 Drawer
- [x] 病种列表：暂不展示
- [x] 身故责任：默认显示"不包含"
- [x] 按钮命名：统一"查看合同详情"

---

**文档版本**：v1.0  
**创建时间**：2026-01-22  
**状态**：待确认



