# 保险公式标准术语表

**版本**: v1.0  
**更新日期**: 2026-01-10  
**用途**: 定义公式中使用的标准术语，确保前后端一致识别

---

## 📋 术语分类

### 1. 保额类术语

| 标准术语 | 英文映射 | 说明 | 示例 |
|---------|---------|------|------|
| 基本保额 | basicCoverage | 投保时约定的基本保险金额 | `基本保额 * 100%` |
| 有效保额 | effectiveCoverage | 带增长率的保险金额 | `有效保额` |
| 现金价值 | cashValue | 保单的现金价值 | `Max(基本保额, 现金价值)` |
| 基本保险金额 | basicCoverage | 同"基本保额" | `基本保险金额 * 50%` |

**注意**：
- "基本保额"和"基本保险金额"是同义词，统一为 `basicCoverage`
- 原文如果用"基本保险金额"，公式中统一简化为"基本保额"

---

### 2. 保费类术语

| 标准术语 | 英文映射 | 说明 | 示例 |
|---------|---------|------|------|
| 已交保费 | paidPremium | 累计已支付的保险费 | `已交保费` |
| 年交保费 | annualPremium | 每年支付的保险费 | `年交保费 * 20` |

**注意**：
- "退还已交保费"、"给付已交保费" → 统一为 `已交保费`

---

### 3. 动态变量术语⭐️ 重要

| 标准术语 | 英文映射 | 数据来源 | 说明 | 示例 |
|---------|---------|---------|------|------|
| 保单年度数 | policyYearNumber | policyYearRange | 从保单生效起的年数（1, 2, 3...） | `基本保额 * 保单年度数` |
| 交费年度数 | paymentYearNumber | paymentPeriodStatus | 已交费的年数 | `基本保额 * 交费年度数 * 105%` |
| 确诊年龄 | diagnosisAge | ageConditions | 确诊时被保险人的年龄 | `基本保额 * (200% - 确诊年龄 * 1%)` |
| 投保年龄 | applicationAge | ageConditions | 投保时被保险人的年龄 | `基本保额 * (150% - 投保年龄 * 0.5%)` |

**注意**：
- 这些术语对应的具体数值，后端根据配套字段动态计算
- 例如："保单年度数"从 `policyYearRange` 获取当前年度

---

### 4. 特殊术语

| 标准术语 | 英文映射 | 说明 | 示例 |
|---------|---------|------|------|
| 确诊当年度保额 | currentYearCoverage | 确诊时该保单年度的保额 | `确诊当年度保额` |
| 身故时保额 | deathCoverage | 身故时的保额 | `身故时保额` |

---

## 🔧 运算符和函数

| 运算符/函数 | 说明 | 示例 |
|-----------|------|------|
| `*` | 乘法 | `基本保额 * 100%` |
| `+` | 加法 | `基本保额 + 已交保费` |
| `-` | 减法 | `基本保额 - 现金价值` |
| `Min(A, B)` | 取最小值 | `Min(基本保额 * 保单年度数, 基本保额 * 20)` |
| `Max(A, B)` | 取最大值 | `Max(基本保额, 现金价值)` |
| `()` | 优先级分组 | `基本保额 * (100% + 5% * 保单年度数)` |

---

## 📝 完整示例

### 示例1：简单比例
```json
{
  "formula": "基本保额 * 30%"
}
```

### 示例2：保单年度递增
```json
{
  "formula": "基本保额 * 保单年度数",
  "policyYearRange": {
    "start": 1,
    "end": null
  }
}
```

### 示例3：保单年度递增（带上限）
```json
{
  "formula": "Min(基本保额 * 保单年度数, 基本保额 * 20)",
  "policyYearRange": {
    "start": 1,
    "end": null
  }
}
```

### 示例4：交费年度相关
```json
{
  "formula": "基本保额 * 交费年度数 * 105%",
  "paymentPeriodStatus": "during"
}
```

### 示例5：年龄递减
```json
{
  "formula": "基本保额 * (200% - 确诊年龄 * 1%)",
  "ageConditions": [
    {"limit": 60, "operator": "<", "type": "确诊时"}
  ]
}
```

### 示例6：复合增长
```json
{
  "formula": "基本保额 * (100% + 5% * 保单年度数)",
  "policyYearRange": {
    "start": 1,
    "end": null
  }
}
```

### 示例7：取较大值
```json
{
  "formula": "Max(基本保额, 现金价值)"
}
```

---

## ⚠️ 废弃规范

以下规范已废弃，不再使用：

❌ **废弃：字母变量**
```json
// 旧方式（已废弃）
{
  "formula": "基本保额 * N",
  "formulaVariables": "N = 保单年度数"
}

// 新方式（推荐）
{
  "formula": "基本保额 * 保单年度数",
  "policyYearRange": {"start": 1, "end": null}
}
```

❌ **废弃：formulaVariables 字段**
- 绝大多数情况不再需要
- 仅在极特殊情况下作为补充说明使用

---

## 🎯 后端实现要点

### 1. 术语识别

后端维护术语映射表：
```javascript
const FORMULA_TERMS = {
  '基本保额': 'basicCoverage',
  '基本保险金额': 'basicCoverage',  // 同义词
  '有效保额': 'effectiveCoverage',
  '现金价值': 'cashValue',
  '已交保费': 'paidPremium',
  '保单年度数': 'policyYearNumber',
  '交费年度数': 'paymentYearNumber',
  '确诊年龄': 'diagnosisAge',
  '投保年龄': 'applicationAge'
};
```

### 2. 动态变量计算

识别到动态变量时，从对应字段获取数值：
- `保单年度数` → 从 `policyYearRange` 和当前日期计算
- `交费年度数` → 从 `paymentPeriodStatus` 和交费记录计算
- `确诊年龄` → 从 `ageConditions` 和出生日期计算

### 3. 公式求值

```javascript
// 示例：Min(基本保额 * 保单年度数, 基本保额 * 20)
const basicCoverage = 500000;  // 用户配置
const policyYear = 15;         // 从policyYearRange计算

const result = Math.min(
  basicCoverage * policyYear,
  basicCoverage * 20
);
// 结果：Math.min(7500000, 10000000) = 7500000
```

---

## 📌 更新历史

| 日期 | 版本 | 变更内容 |
|------|------|---------|
| 2026-01-10 | v1.0 | 初始版本，废弃字母变量，改用中文术语 |

